<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>종합부동산세 계산기</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 40px;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
        }

        table, th, td {
            border: 1px solid black;
            padding: 8px;
            text-align: left;
        }

        th {
            background-color: #f2f2f2;
        }

        input[type="number"] {
            padding: 5px;
            width: 200px;
        }

        button {
            padding: 8px 16px;
            margin-left: 10px;
        }
    </style>
</head>
<body>

<h2>종합부동산세 계산기</h2>
<p>
    공시가격 합산:
    <input type="number" id="priceInput" placeholder="공시가격 합산">
    주택 수:
    <input type="number" id="houseCountInput" placeholder="주택 수">
    <button onclick="calculateTax()">세액 계산하기</button>
    <button onclick="resetFields()">리셋</button>
</p>

<p id="result"></p>

<script>
    function formatNumberWithCommas(number) {
        return number.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",");
    }

    function calculateTax() {
        const price = parseInt(document.getElementById("priceInput").value);
        const houseCount = parseInt(document.getElementById("houseCountInput").value);
        const deduction = houseCount === 1 ? 1200000000 : 900000000;
        let taxableAmount = (price - deduction) * 0.6;
        
        let tax;
        if (houseCount <= 2) {
            tax = computeTax(taxableAmount, [0.0015, 1500000, 3600000, 9600000, 26500000, 64000000, 152000000], [0.0005, 0.0007, 0.001, 0.0013, 0.0015, 0.002, 0.0027]);
        } else {
            tax = computeTax(taxableAmount, [0.0015, 1500000, 3600000, 9600000, 35600000, 110600000, 286660000], [0.0005, 0.0007, 0.001, 0.002, 0.003, 0.004, 0.005]);
        }
        
        document.getElementById("result").innerText = `세액은 ${formatNumberWithCommas(tax)}원 입니다.`;
    }

    function computeTax(taxableAmount, baseTax, taxRates) {
        const thresholds = [300000000, 600000000, 1200000000, 2500000000, 5000000000, 9400000000, Infinity];
        for (let i = 0; i < thresholds.length; i++) {
            if (taxableAmount <= thresholds[i]) {
                return baseTax[i] + ((taxableAmount - (thresholds[i-1] || 0)) * taxRates[i]);
            }
        }
    }

    function resetFields() {
        document.getElementById("priceInput").value = '';
        document.getElementById("houseCountInput").value = '';
        document.getElementById("result").innerText = '';
    }
</script>

</body>
</html>