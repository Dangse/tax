<!DOCTYPE html>
<html lang="ko">
<head>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="css/styles.css">
    
    <title>상속세셀프계산기</title>
   
</head>
<body>
    <h1>상속세 셀프 계산기 </h1>

    <h3>◈ 기본사항</h3>
    <ol>
        <li>부모님중 한분이 먼저 돌아가신 경우.</li>
        <li>피상속인이 1주택과 그외 자산을 소유.</li>
        <li>자산과 부채는 사망일 당시금액. 사망신고일이 아님 유의.</li>
    </ol>

    <div id="step1">
        <h2>주택</h2>      
        <div style="display: flex; flex-direction: column; align-items: left; gap: 10px;">
            <input type="text" id="houseValue" inputmode="numeric" oninput="formatNumber(this)">
            <button onclick="nextStep(2)">다음</button>
        </div>   
        

        <ul>
            <li>시가평가 원칙.</li>
            <li>시가는 이 주택의 감정평가액 또는 매매사례가액.</li>
            <li>시가가 없는 경우 기준시가 평가.</li>
        </ul>
    </div>

    <div id="step2" style="display: none;">
        <h2>건물(대지 포함) </h2>       
        <div style="display: flex; flex-direction: column; align-items: left; gap: 10px;">
            <input type="text" id="buildingValue" inputmode="numeric" oninput="formatNumber(this)">
            
            <div style="display: flex; justify-content:left ; gap: 20px;">
                <button onclick="previousStep(1)">뒤로가기</button>
                <button onclick="nextStep(3)">다음</button>
            </div>
        </div>
        <ul>
            <li>시가로 평가.</li>
            <li>감정평가가액이 있는 경우 감정가액.</li>
            <li>시가가 없는 경우 기준시가로 평가.</li>
            <li>고가의 건물의 경우, 2020년부터 기준시가로 과세하는 것에 대한 과세 형평성 문제가 제기되었습니다.</li>
            <li>국세청은 자체 감정평가예산을 배정하여 예상감정가와 시가의 차액이 10억을 넘거나 , 
                10%이상 차이가 나는 경우 감정평가를 하여 과세하고 있습니다.  
                [국세청 훈령 제2580호 상속세 및 증여세 사무처리 규정]</li>
        </ul>
    </div>

    <div id="step3" style="display: none;">
        <h2> 농지 </h2>        
        <div style="display: flex; flex-direction: column; align-items: left; gap: 10px;">
            <input type="text" id="agriculturalLandValue" inputmode="numeric" oninput="formatNumber(this)">
            
            <div style="display: flex; justify-content:left ; gap: 20px;">
                <button onclick="previousStep(2)">뒤로가기</button>
                <button onclick="nextStep(4)">다음</button>   
            </div>
        </div>             
        
        
        <ul>
            <li>시가로 평가.</li>
            <li>시가는 감정평가액이 될수 있음.</li>
            <li>시가가 없는 경우 기준시가로 평가.</li>   
        </ul> 
    </div>

    <div id="step4" style="display: none;">
        <h2>임야 </h2>
        <div style="display: flex; flex-direction: column; align-items: left; gap: 10px;">
            <input type="text" id="forestLandValue" inputmode="numeric" oninput="formatNumber(this)">
            
            <div style="display: flex; justify-content:left ; gap: 20px;">
                <button onclick="previousStep(3)">뒤로가기</button>
                <button onclick="nextStep(5)">다음</button>
            </div>   
        </div>       
               
        
        
        <ul>
            <li>시가로 평가.</li>
            <li>시가는 감정평가액이 될수 있음.</li>
            <li>시가가 없는 경우 기준시가로 평가.</li>
    </div>

    <div id="step5" style="display: none;">
        <h2>금융자산 등 그외상속재산</h2>
        <div style="display: flex; flex-direction: column; align-items: left; gap: 10px;">
            <input type="text" id="otherProperty" inputmode="numeric" oninput="formatNumber(this)">   
            <div style="display: flex; justify-content:left ; gap: 20px;">
                <button onclick="previousStep(4)">뒤로가기</button>
                <button onclick="nextStep(6)">다음</button>
            </div>
        </div>
    </div>

    <div id="step6" style="display: none;">
        <h2>채무 및 공과금</h2>
        <div style="display: flex; flex-direction: column; align-items: left; gap: 10px;">
            <input type="text" id="debts" inputmode="numeric" oninput="formatNumber(this)">       
            <div style="display: flex; justify-content:left ; gap: 20px;">
                <button onclick="previousStep(5)">뒤로가기</button>
                <button onclick="nextStep(7)">다음</button>
            </div>
        </div>
    </div>

    <div id="step7" style="display: none;">
        <h2>장례비용</h2>
        <div style="display: flex; flex-direction: column; align-items: left; gap: 10px;">
            <input type="text" id="funeralExpense" inputmode="numeric" oninput="formatNumber(this)" placeholder="5백이하시 5,000,000">    
            <div style="display: flex; justify-content:left ; gap: 20px;">   
                <button onclick="previousStep(6)">뒤로가기</button>
                <button onclick="nextStep(8)">다음</button>
            </div>

        </div>
        <ul>
           
            <li>장례비(봉안시설비 제외),5백만원 미만시 5백만원.</li> 
            <li>1천만원 초과시 1천만원까지만 공제.</li> 
            <li>봉안시설, 자연장지에 사용된 금액은 별도로 5백만원을 한도로 공제.</li> 
                  
        </ul>
    </div>

    <div id="step8" style="display: none;">
        <h2>사전증여재산</h2>
        <div style="display: flex; flex-direction: column; align-items: left; gap: 10px;"></div>
            <input type="text" id="giftFromMother" inputmode="numeric" oninput="formatNumber(this)" placeholder="10년내 배우자 증여 금액"> 
            <input type="text" id="giftToChildren" inputmode="numeric" oninput="formatNumber(this)" placeholder="10년 자녀 증여 증여 금액">  
            <input type="text" id="giftToOthers" inputmode="numeric" oninput="formatNumber(this)" placeholder="5년내 상속인 외 증여 금액 예) 손자 손녀">
            <input type="text" id="giftTaxDeduction" inputmode="numeric" oninput="formatNumber(this)" placeholder="위 증여시 산출된 증여세 합계">  
       
            <div style="display: flex; justify-content:left ; gap: 20px;"></div>
                <button onclick="previousStep(7)">뒤로가기</button>
                <button onclick="nextStep(9)">다음</button>
            </div>    
        </div>
    </div>

    
    <div id="step9" style="display: none;">
        <h2>상속공제</h2>
        <div style="display: flex; flex-direction: column; align-items: left; gap: 10px;">
            <input type="text" id="inheritanceDeduction" inputmode="numeric" oninput="formatNumber(this)"placeholder=" 최소 1,000,000,000을 적으세요 " >  
            <div style="display: flex; justify-content:left ; gap: 20px;">
                <button onclick="previousStep(8)">뒤로가기</button>
                <button onclick="nextStep(10)">다음</button>
            </div>
        </div>
        <ul>
            <li>배우자가 생존해 있는 경우 최소 10억원.</li>
            <li>사전증여가 많은 경우 10억이 안될수 있음.</li>
            <li>그외 금융상속공제, 동거주택상속공제 등이 있음.</li>
            
        </ul>

    </div>

    <div id="step10" style="display: none;">
        <h2>감정평가수수료</h2>
        <div style="display: flex; flex-direction: column; align-items: left; gap: 10px;">
            <input type="text" id="appraisalFee" inputmode="numeric" oninput="formatNumber(this)">  
            <div style="display: flex; justify-content:left ; gap: 20px;">
                <button onclick="previousStep(9)">뒤로가기</button>
                <button onclick="nextStep(11); calculateInheritanceTax();">상속세계산</button>
            </div>
            

        </div>

        <ul>
            <li>5백만원 한도</li>
               
        </ul>

    </div>  

    <div id="step11"  style="display: none;">

        <h2>계산 결과</h2>
        <table border="1" id="resultTable">
            <thead>
                <tr>
                    <th>구분</th>
                    <th>금액</th>
                    <th>비고</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td>(1) 총상속재산가액</td>
                    <td id="totalPropertyValueCell" style="text-align: right;"></td>
                    <td style="text-align: center;">상속재산 총합 </td>
                </tr>
                <tr>
                    <td>(2) 채무 및 공과금</td>
                    <td id="debtsValueCell" style="text-align: right;"></td>
                    <td></td>
                </tr>
                <tr>
                    <td>(3) 장례비용 </td>
                    <td id="funeralExpenseValueCell" style="text-align: right;"></td>
                    <td style="text-align: center;">최소 5백공제. 최대 1천5백 한도.</td>
                </tr>
                <tr>
                    <td>(4) 사전증여재산</td>
                    <td id="priorGiftsValueCell" style="text-align: right;"></td>
                    <td style="text-align: center;"></td>
                </tr>
                <tr>
                    <td>(5) 상속세 과세가액</td>
                    <td id="taxableAmountValueCell" style="text-align: right;"></td>
                    <td style="text-align: center;">(1) - (2) + (3)</td>
                </tr>
                <tr>
                    <td>(6) 상속공제</td>
                    <td id="inheritanceDeductionValueCell" style="text-align: right;"></td>
                    <td style="text-align: center;">배우자 생존시 최소 10억</td>
                </tr>
                <tr>
                    <td>(7) 감정평가수수료</td>
                    <td id="appraisalFeeValueCell" style="text-align: right;"></td>
                    <td style="text-align: center;"> 5백만 원 한도</td>
                </tr>
                <tr>
                    <td>(8) 상속세 과세표준</td>
                    <td id="taxBaseValueCell" style="text-align: right;"></td>
                    <td style="text-align: center;">(4) - (5) - (6)</td>
                </tr>
                <tr>
                    <td>(9) 세율</td>
                    <td id="taxRateValueCell" style="text-align: right;">10%~50%</td>
                    <td style="text-align: center;">누진세율</td>
                </tr>
                <tr>
                    <td>(10) 산출세액</td>
                    <td id="calculatedTaxValueCell" style="text-align: right;"></td>
                    <td style="text-align: center;">(7) × (8)</td>
                </tr>
                <tr>
                    <td>(11) 세액공제</td>
                    <td id="taxDeductionValueCell" style="text-align: right;"></td>
                    <td style="text-align: center;">증여세액공제 + 신고세액공제 3%</td>
                </tr>
                <tr>
                    <td>(12) 자진납부할세액</td>
                    <td id="payableTaxValueCell" style="text-align: right;"></td>
                    <td style="text-align: center;">(9) - (10)</td>
                </tr>
            </tbody>
        </table>

        <button onclick="previousStep(10)">뒤로가기</button> <br> <br> 

        
        <button onclick="previousStep(14)"> 상속세 절세방법 (준비중) </button> <br><br>

        
        <button onclick="previousStep(14)"> 상속받은 주택 이렇게 하세요! (준비중)</button> <br><br>  

        

           
    </div>

    
    <script>
        function nextStep(stepNum) {
            document.getElementById("step" + (stepNum - 1)).style.display = "none";
            document.getElementById("step" + stepNum).style.display = "block";
        }

        function previousStep(stepNum) {
            document.getElementById("step" + (stepNum + 1)).style.display = "none";
            document.getElementById("step" + stepNum).style.display = "block";
            document.getElementById("results").style.display = "none";
           
        }
     
 //상속세 계산기
        function calculateInheritanceTax() {
            var houseValue = parseFloat(document.getElementById('houseValue').value.replace(/,/g, '')) || 0;
            var buildingValue = parseFloat(document.getElementById('buildingValue').value.replace(/,/g, '')) || 0;
            var agriculturalLandValue = parseFloat(document.getElementById('agriculturalLandValue').value.replace(/,/g, '')) || 0;
            var forestLandValue = parseFloat(document.getElementById('forestLandValue').value.replace(/,/g, '')) || 0;
            var otherProperty = parseFloat(document.getElementById('otherProperty').value.replace(/,/g, '')) || 0;
            var debts = parseFloat(document.getElementById('debts').value.replace(/,/g, '')) || 0;

            var funeralExpenseInput = parseFloat(document.getElementById('funeralExpense').value.replace(/,/g, '')); // 입력값
            var funeralExpense = funeralExpenseInput || 5000000; // 입력값이 없을 경우 기본값은 500만원
            // 입력값이 150만을 초과하는 경우 150만으로 조정
            if (funeralExpense > 15000000) {
                funeralExpense = 15000000;
            }

            var giftFromMother = parseFloat(document.getElementById('giftFromMother').value.replace(/,/g, '')) || 0;
            var giftToChildren = parseFloat(document.getElementById('giftToChildren').value.replace(/,/g, '')) || 0;
            var giftToOthers = parseFloat(document.getElementById('giftToOthers').value.replace(/,/g, '')) || 0;
            var inheritanceDeduction = parseFloat(document.getElementById('inheritanceDeduction').value.replace(/,/g, '')) || 1000000000; 
            var appraisalFee = parseFloat(document.getElementById('appraisalFee').value.replace(/,/g, '')) || 0;
            var giftTaxDeduction = parseFloat(document.getElementById('giftTaxDeduction').value.replace(/,/g, '')) || 0;

            var totalProperty = houseValue + buildingValue + agriculturalLandValue + forestLandValue + otherProperty;
            var priorGifts = giftFromMother + giftToChildren + giftToOthers;
            var taxableAmount = totalProperty - debts - funeralExpense + priorGifts;
        
            var taxBase = Math.max(0, taxableAmount - inheritanceDeduction - appraisalFee);
            var calculatedTax = calculateInheritTariff(taxBase); calculatedTax = Math.floor(calculatedTax); // 소수점 이하를 절사하여 할당           
            var taxDeduction = giftTaxDeduction + (calculatedTax -giftTaxDeduction) * 0.03; taxDeduction = Math.floor(taxDeduction); // 소수점 이하를 절사하여 할당
            var payableTax = Math.max(0, calculatedTax - taxDeduction);payableTax = Math.floor(payableTax / 10) * 10; // 10의 자리를 절사하여 할당

            document.getElementById('totalPropertyValueCell').innerText = totalProperty.toLocaleString();
            document.getElementById('debtsValueCell').innerText = debts.toLocaleString();
            document.getElementById('funeralExpenseValueCell').innerText = funeralExpense.toLocaleString();
            document.getElementById('priorGiftsValueCell').innerText = priorGifts.toLocaleString();
            document.getElementById('taxableAmountValueCell').innerText = taxableAmount.toLocaleString();
            document.getElementById('inheritanceDeductionValueCell').innerText = inheritanceDeduction.toLocaleString();
            document.getElementById('appraisalFeeValueCell').innerText = appraisalFee.toLocaleString();
            document.getElementById('taxBaseValueCell').innerText = taxBase.toLocaleString();
            document.getElementById('calculatedTaxValueCell').innerText = calculatedTax.toLocaleString();
            document.getElementById('taxDeductionValueCell').innerText = taxDeduction.toLocaleString();
            document.getElementById('payableTaxValueCell').innerText = payableTax.toLocaleString();
        }
// 상속세율표

function calculateInheritTariff(taxBase) {
    if (taxBase <= 100000000) {
        return taxBase * 0.1; // 10%
    } else if (taxBase <= 500000000) {
        return taxBase * 0.2 - 10000000; // 20%, 10,000,000원 공제
    } else if (taxBase <= 1000000000) {
        return taxBase * 0.3 - 60000000; // 30%, 60,000,000원 공제
    } else if (taxBase <= 3000000000) {
        return taxBase * 0.4 - 160000000; // 40%, 160,000,000원 공제
    } else {
        return taxBase * 0.5 - 460000000; // 50%, 460,000,000원 공제
    }
}
  
    function formatNumber(input) {
        // Remove commas and non-numeric characters
        var numericValue = input.value.replace(/,/g, '').replace(/\D/g, '');
        // Format with commas and update the input value
        input.value = numericValue.replace(/\B(?=(\d{3})+(?!\d))/g, ",");
    }

    </script>
</body>
</html>
